// Copyright 2015 Christian Roggia. All rights reserved.
// Use of this source code is governed by an Apache 2.0 license that can be
// found in the LICENSE file.

#include "..\Global\Global.h"

namespace Shamoon { namespace Modules { namespace Handler {
	static SERVICE_STATUS dwSvcStatus; /// <-- Service status
	static SERVICE_STATUS_HANDLE hSvcStatusHandle; /// <-- Service status handle
	static bool bSvcStopped; /// <-- Service has been stopped

	VOID ReportSvcStatus(DWORD dwCurrentState, DWORD dwWin32ExitCode, DWORD dwWaitHint);
	VOID WINAPI SvcCtrlHandler(DWORD dwCtrl);
	VOID WINAPI SvcMain(DWORD dwArgc, LPWSTR lpszArgv);
	VOID SvcSleep(DWORD dwSeconds);
}}}